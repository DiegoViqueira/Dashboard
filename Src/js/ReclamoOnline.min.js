/*! Reclamo Online 2016-11-03 
 Autor: Diego Viqueira 
 Date: 01-05-2016 
 Copyrigths: Reclamo On-line */
!function(){"use strict";function decode_tables(a){if(a){for(var b=a.length,c="",d=[],e=[],f=0;f<b;f++)a[f].grupo!=c?(e.length>0&&d.push({grupo:c,tables:e}),e=[],c=a[f].grupo,e.push({modulo:a[f].modulo,archivo:a[f].archivo,icono:a[f].icono})):e.push({modulo:a[f].modulo,archivo:a[f].archivo,icono:a[f].icono});return e.length>0&&d.push({grupo:c,tables:e}),d}}function getPHPSessId(){var a=document.cookie.match(/PHPSESSID=[^;]+/);if(null==a)return"";if("undefined"==typeof a)return"";if(a.length<=0)return"";a=a[0];var b=a.lastIndexOf(";");return b==-1&&(b=a.length),a.substring(10,b)}var myapp=angular.module("MainAplication",["ngMaterial","ngRoute","ngMessages","ngAnimate","ngSanitize","ngCookies","n3-pie-chart","ngFileUpload","md.data.table","googlechart","ngFacebook"]);myapp.config(["$mdThemingProvider","$facebookProvider",function(a,b){a.theme("default").primaryPalette("teal",{default:"400","hue-1":"100","hue-2":"600","hue-3":"A100"}),a.theme("alt").primaryPalette("teal",{default:"400","hue-1":"100","hue-2":"600","hue-3":"A100"}).dark(),b.setAppId("184422655328299").setPermissions(["email","public_profile"])}]),myapp.run(["$rootScope","$window",function(a,b){!function(a,b,c){var d,e=a.getElementsByTagName(b)[0];a.getElementById(c)||(d=a.createElement(b),d.id=c,d.src="//connect.facebook.net/en_US/sdk.js",e.parentNode.insertBefore(d,e))}(document,"script","facebook-jssdk"),a.$on("fb.load",function(){b.dispatchEvent(new Event("fb.load"))})}]),myapp.config(["$routeProvider",function(a,b){console.log("routeProvider reporting for duty. page required."),a.when("/",{templateUrl:"pages/home.php",controller:"MainController"}).when("/:name",{templateUrl:function(a){return"pages/"+a.name+".php"},controller:"MainController"}).otherwise("/404",{templateUrl:"pages/404.php",controller:"MainController"})}]),myapp.directive("panelWidget",["$rootScope",function(a){return{restrict:"E",replace:!0,transclude:!0,scope:{title:"@",template:"@",options:"@"},template:'<section layout-margin class="panel-widget" flex >  <md-toolbar layout-padding class="md-hue-1 panel-widget-toolbar" >    <div class="md-toolbar-tools" flex >      <h3 class="panel-widget-tittle">{{title}}</h3>      <span flex></span>      <md-button ng-show="options" ng-click="$showOptions = !$showOptions" class="md-icon-button" aria-label="Show options">        <i class="material-icons">more_vert</i>      </md-button>    </div>  </md-toolbar>  <div ng-include="template"/></section>',compile:function(a,b,c){return function(a,b){c(a,function(a){b.append(a)})}}}}]),myapp.controller("AdminUsersEmpresaCtrl",["$scope","$cookies","$http","$rootScope","$mdDialog","$mdToast",function($scope,$cookies,$http,$rootScope,$mdDialog,$mdToast){console.log("AdminUsersEmpresaCtrl reporting for duty."),$scope.Usuarios=[],$scope.searchFish="";var request=$http({method:"post",url:"lib/get_users_empresa.php",data:{id_empresa:$rootScope.User.id}});request.success(function(data){var result=eval(data);"1"==result.ERROR?Array.isArray(result.DATA)?($scope.Usuarios.count=result.DATA.length,$scope.Usuarios.data=result.DATA):($scope.Usuarios.count=1,$scope.Usuarios.data=[],$scope.Usuarios.data.push(result.DATA)):"0"==result.ERROR?$mdToast.show($mdToast.simple().textContent("No existen usuarios.").position("bottom").hideDelay(3e3)):$mdToast.show($mdToast.simple().textContent("ERROR DESONOCIDO!").position("bottom").hideDelay(3e3))}),$scope.selected=[],$scope.detail=[],$scope.filter={options:{debounce:500}},$scope.limitOptions=5,$scope.query={order:"id",limit:10,page:1},$scope.logItem=function(a){},$scope.inactive=function(a,b){var c=angular.element(document.body);$mdDialog.show({parent:c,targetEvent:a,template:'<md-dialog aria-label="List dialog" flex-gt-xs="80">  <md-dialog-content><md-toolbar><div class="md-toolbar-tools"><h2> Cambiar Estado de Usuario </h2><span flex></span></div></md-toolbar><md-content   layout-padding flex="auto" ><form name="gestionInactiveForm " ng-submit="procesar(Status_nuevo)" >\t\t<md-input-container class="md-block">\t\t\t<label>Respuesta</label><md-select required ng-model="Status_nuevo" placeholder="Seleccionar Estado"><md-option ng-value="1">Inactivo</md-option><md-option ng-value="0">Activo</md-option></md-select><div ng-messages="gestionInactiveForm.Status_nuevo.$error" role="alert">  <div ng-message-exp="[\'required\']">\tPor Favor ingrese un estado valido.  </div></div>\t\t</md-input-container>\t<div layout="row" layout-sm="column"  layout-align="space-around">\t\t  <md-progress-circular md-mode="indeterminate" ng-show="spinner"></md-progress-circular>\t</div>\t<div layout-gt-sm="row" layout-align="center center">\t<md-button type="submit" ng-disabled="gestionInactiveForm.$invalid" class="md-raised md-primary" >Procesar</md-button>\t</div></form></md-content>  </md-dialog-content>  <md-dialog-actions>    <md-button ng-click="closeDialog()" class="md-primary">      Cerrar Ventana    </md-button>  </md-dialog-actions></md-dialog>',locals:{id_cliente:b.id},controller:"DialogControllerAdmUsr"}).then(function(a,c){"OK"==a&&(b.state=c)})}}]),myapp.controller("DialogControllerAdmUsr",["$scope","$rootScope","$mdDialog","id_cliente","$http","$mdToast",function($scope,$rootScope,$mdDialog,id_cliente,$http,$mdToast){$scope.id_cliente=id_cliente,$scope.spinner=!1,$scope.closeDialog=function(){$mdDialog.hide()},$scope.procesar=function(status_nuevo){$scope.spinner=!0;var request=$http({method:"post",url:"lib/inactive_user.php",data:{id_usuario:$scope.id_cliente,id_estado:status_nuevo}});request.success(function(data){var ret=eval(data);1==ret.STATUS?($mdToast.show($mdToast.simple().textContent(ret.MENSAJE).position("bottom").hideDelay(3e3)),$mdDialog.hide("OK",status_nuevo)):$mdToast.show($mdToast.simple().textContent(ret.MENSAJE).position("bottom").hideDelay(3e3))}),$scope.spinner=!1}}]),myapp.controller("ContactoCtrl",["$scope","$location","$cookies","$http","$rootScope","$mdSidenav","$mdDialog","$mdToast",function($scope,$location,$cookies,$http,$rootScope,$mdSidenav,$mdDialog,$mdToast){console.log("ContactoCtrl reporting for duty."),$scope.sendMail=function(){var request=$http({method:"post",url:"lib/send_mail.php",data:eval($scope.vm)});request.success(function(data){var resp=eval(data);1==resp.ERROR?($mdToast.show($mdToast.simple().textContent(data.MENSAJE).position("bottom").hideDelay(3e3)),$scope.vm.mensaje=null,$scope.vm.email=null,$scope.vm.empresa=null,$scope.ContactForm.mensaje.$error={},$scope.ContactForm.email.$error={},$scope.ContactForm.empresa.$error={},$scope.ContactForm.$invalid=!0,$scope.ContactForm.$setUntouched(),$scope.ContactForm.$setPristine(),$scope.ContactForm.$submitted=!1):$mdToast.show($mdToast.simple().textContent(data.MENSAJE).position("bottom").hideDelay(3e3))})}}]),myapp.controller("DasboardAdminCtrl",["$scope","$location","$cookies","$http","$rootScope","$mdSidenav",function($scope,$location,$cookies,$http,$rootScope,$mdSidenav){console.log("DasboardAdminCtrl reporting for duty.");var request4=$http({method:"post",url:"lib/get_estadisticas.php",data:$rootScope.User});request4.success(function(data){var result=eval(data);$scope.meses=result.MONTH,Array.isArray(result.TOTAL)?$scope.totales=result.TOTAL:($scope.totales=[],$scope.totales.push(result.TOTAL));var dateObj=new Date,month=dateObj.getUTCMonth();$scope.gauge_options={thickness:5,mode:"gauge",total:$scope.meses[Number(month)].cant+.01*$scope.meses[Number(month)].cant},$scope.gauge_data=[{label:"Cant",value:$scope.meses[Number(month)].cant,suffix:"",color:"steelblue"}],$scope.myChartObject={},$scope.myChartObject.type="ColumnChart",$scope.myChartObject.data={cols:[{id:"t",label:"Topping",type:"string"},{id:"s",label:"cant",type:"number"}],rows:[{c:[{v:"E"},{v:$scope.meses[0].cant}]},{c:[{v:"F"},{v:$scope.meses[1].cant}]},{c:[{v:"M"},{v:$scope.meses[2].cant}]},{c:[{v:"A"},{v:$scope.meses[3].cant}]},{c:[{v:"M"},{v:$scope.meses[4].cant}]},{c:[{v:"J"},{v:$scope.meses[5].cant}]},{c:[{v:"J"},{v:$scope.meses[6].cant}]},{c:[{v:"A"},{v:$scope.meses[7].cant}]},{c:[{v:"S"},{v:$scope.meses[8].cant}]},{c:[{v:"O"},{v:$scope.meses[9].cant}]},{c:[{v:"N"},{v:$scope.meses[10].cant}]},{c:[{v:"D"},{v:$scope.meses[11].cant}]}]}})}]),myapp.controller("DasboardCtrl",["$scope","$location","$cookies","$http","$rootScope","$mdSidenav","$timeout","$mdDialog",function($scope,$location,$cookies,$http,$rootScope,$mdSidenav,$timeout,$mdDialog){console.log("DasboardCtrl reporting for duty."),$scope.hidden=!1,$scope.isOpen=!1,$scope.hover=!1,$scope.$watch("isOpen",function(a){a?$timeout(function(){$scope.tooltipVisible=$scope.isOpen},600):$scope.tooltipVisible=$scope.isOpen}),$scope.items=[{name:"Nuevo Reclamo",icon:"note_add",direction:"bottom"},{name:"Menu",icon:"list",direction:"bottom"}],$scope.openDialog=function(a,b){"Nuevo Reclamo"==b.name?$location.path("/new_claim"):"Menu"==b.name&&$mdSidenav("left").open()},$scope.goto_ref=function(a){"PENDIENTE"==a?$location.path("/pend_claim"):"CERRADO"==a?$location.path("/old_claim"):$location.path("/new_claim")};var request4=$http({method:"post",url:"lib/get_estadisticas.php",data:$rootScope.User});request4.success(function(data){var result=eval(data);$scope.meses=result.MONTH,Array.isArray(result.TOTAL)?$scope.totales=result.TOTAL:($scope.totales=[],$scope.totales.push(result.TOTAL));var dateObj=new Date,month=dateObj.getUTCMonth();$scope.gauge_options={thickness:5,mode:"gauge",total:$scope.meses[Number(month)].cant+.01*$scope.meses[Number(month)].cant},$scope.gauge_data=[{label:"Cant",value:$scope.meses[Number(month)].cant,suffix:"",color:"steelblue"}],$scope.myChartObject={},$scope.myChartObject.type="ColumnChart",$scope.myChartObject.data={cols:[{id:"t",label:"Topping",type:"string"},{id:"s",label:"cant",type:"number"}],rows:[{c:[{v:"E"},{v:$scope.meses[0].cant}]},{c:[{v:"F"},{v:$scope.meses[1].cant}]},{c:[{v:"M"},{v:$scope.meses[2].cant}]},{c:[{v:"A"},{v:$scope.meses[3].cant}]},{c:[{v:"M"},{v:$scope.meses[4].cant}]},{c:[{v:"J"},{v:$scope.meses[5].cant}]},{c:[{v:"J"},{v:$scope.meses[6].cant}]},{c:[{v:"A"},{v:$scope.meses[7].cant}]},{c:[{v:"S"},{v:$scope.meses[8].cant}]},{c:[{v:"O"},{v:$scope.meses[9].cant}]},{c:[{v:"N"},{v:$scope.meses[10].cant}]},{c:[{v:"D"},{v:$scope.meses[11].cant}]}]}})}]),myapp.controller("HeaderCtrl",["$scope","$location","$cookies","$rootScope","$mdSidenav","$facebook",function(a,b,c,d,e,f){console.log("HeaderCtrl reporting for duty."),d.signed=c.get("signed"),d.User=c.getObject("User"),d.AsideTables=c.getObject("Tables"),d.Companies=c.getObject("Companies"),d.Status=c.getObject("Status"),d.UnreadMessages=c.getObject("UnreadMessages"),d.DefaultPage=c.get("DefaultPage"),a.checkqtty=function(a){return"Cerrados"==a&&"0"!=d.UnreadMessages.cant?" CERRADOS ("+d.UnreadMessages.cant+")":a},d.get_company_name=function(a){var b=c.getObject("Companies");if(Array.isArray(b)){for(var d=0;d<b.length;d++)if(b[d].id==a)return b[d].display;return""}return""},d.get_status_name=function(a){var b=c.getObject("Status");if(Array.isArray(b)){for(var d=0;d<b.length;d++)if(b[d].id==a)return b[d].description;return""}return""},a.process=function(c){var d="/"+c;b.path(d),a.closeSideNavPanel()},a.signout=function(){console.log("signout reporting for duty."),c.remove("signed"),c.remove("User"),c.remove("Tables"),c.remove("Companies"),c.remove("Status"),c.remove("UnreadMessages"),c.remove("DefaultPage"),d.signed=c.get("signed"),d.User=c.getObject("User"),d.AsideTables=c.getObject("Tables"),d.Companies=c.getObject("Companies"),d.Status=c.getObject("Status"),d.UnreadMessages=c.getObject("UnreadMessages"),d.DefaultPage=c.get("DefaultPage"),b.path("/home"),f.isConnected()&&f.logout()},a.openSideNavPanel=function(){e("left").open()},a.closeSideNavPanel=function(){e("left").close()},a.view=[],a.toggle=function(b){a.view[b]=!a.view[b]}}]),myapp.controller("LoginCtrl",["$scope","$location","$cookies","$http","$window","$mdToast","$rootScope","$facebook",function($scope,$location,$cookies,$http,$window,$mdToast,$rootScope,$facebook){console.log("LoginCtrl reporting for duty."),$scope.$on("fb.auth.authResponseChange",function(){$scope.status=$facebook.isConnected(),$scope.status&&$facebook.api("/me",{fields:"email,first_name,last_name,birthday,gender"}).then(function(user){function typeOf(a){return{}.toString.call(a).split(" ")[1].slice(0,-1).toLowerCase()}var request=$http({method:"post",url:"lib/login_fb.php",data:eval(user)});$scope.spinner=!0,request.success(function(data){var response=eval(data);if("string"==typeOf(response))$scope.spinner=!1,$mdToast.show($mdToast.simple().textContent("! "+response).position("bottom").hideDelay(3e3));else{$mdToast.show($mdToast.simple().textContent("Bienvenido a Rec!amos On-Line !!!").position("bottom").hideDelay(3e3)),response.User.notify=Boolean(response.User.notify),$cookies.put("signed",!0),$cookies.putObject("User",response.User),$cookies.putObject("Tables",decode_tables(response.Tables)),$cookies.putObject("UnreadMessages",response.unreadmessages),$cookies.put("DefaultPage",response.DefaultPage.file),$rootScope.signed=$cookies.get("signed"),$rootScope.User=$cookies.getObject("User"),$rootScope.AsideTables=$cookies.getObject("Tables"),$rootScope.UnreadMessages=$cookies.getObject("UnreadMessages"),$rootScope.DefaultPage=$cookies.get("DefaultPage"),$location.path("/"+$rootScope.DefaultPage);var request2=$http({method:"post",url:"lib/get_companys.php"});request2.success(function(data){var res=eval(data);Array.isArray(res)?$rootScope.Companies=res:($rootScope.Companies=[],$rootScope.Companies.push(res)),$cookies.putObject("Companies",$rootScope.Companies)});var request3=$http({method:"post",url:"lib/get_status.php"});request3.success(function(data){$rootScope.Status=eval(data),$cookies.putObject("Status",$rootScope.Status)}),$scope.spinner=!1}})})}),$scope.login_fb=function(){$scope.status?$facebook.logout():$facebook.login()},$cookies.get("signed")&&($mdToast.show($mdToast.simple().textContent("Ya estas conectado al sistema !!").position("bottom").hideDelay(3e3)),$location.path("/home")),$scope.spinner=!1,$scope.login=function(){function typeOf(a){return{}.toString.call(a).split(" ")[1].slice(0,-1).toLowerCase()}var session_id=getPHPSessId();$scope.vm.password=CryptoJS.AES.encrypt(JSON.stringify($scope.vm.password),session_id.toString(),{format:CryptoJSAesJson}).toString();var request=$http({method:"post",url:"lib/login.php",data:eval($scope.vm)});$scope.spinner=!0,request.success(function(data){var response=eval(data);if("string"==typeOf(response))$scope.spinner=!1,$mdToast.show($mdToast.simple().textContent("! "+response).position("bottom").hideDelay(3e3)),$scope.vm.password="";else{$mdToast.show($mdToast.simple().textContent("Bienvenido a Rec!amos On-Line !!!").position("bottom").hideDelay(3e3)),response.User.notify=Boolean(response.User.notify),$cookies.put("signed",!0),$cookies.putObject("User",response.User),$cookies.putObject("Tables",decode_tables(response.Tables)),$cookies.putObject("UnreadMessages",response.unreadmessages),$cookies.put("DefaultPage",response.DefaultPage.file),$rootScope.signed=$cookies.get("signed"),$rootScope.User=$cookies.getObject("User"),$rootScope.AsideTables=$cookies.getObject("Tables"),$rootScope.UnreadMessages=$cookies.getObject("UnreadMessages"),$rootScope.DefaultPage=$cookies.get("DefaultPage"),$location.path("/"+$rootScope.DefaultPage);var request2=$http({method:"post",url:"lib/get_companys.php"});request2.success(function(data){var res=eval(data);Array.isArray(res)?$rootScope.Companies=res:($rootScope.Companies=[],$rootScope.Companies.push(res)),$cookies.putObject("Companies",$rootScope.Companies)});var request3=$http({method:"post",url:"lib/get_status.php"});request3.success(function(data){$rootScope.Status=eval(data),$cookies.putObject("Status",$rootScope.Status)}),$scope.spinner=!1}})}}]),myapp.controller("MainController",["$route","$routeParams",function(a,b){console.log("MainController reporting for duty. page required["+b.name+"]")}]),myapp.controller("ManageClaimCtrl",["$scope","$cookies","$http","$rootScope","$mdDialog","$mdToast","$interval","$timeout",function($scope,$cookies,$http,$rootScope,$mdDialog,$mdToast,$interval,$timeout){console.log("ManageClaimCtrl reporting for duty."),$scope.reclamos=[],$scope.searchFish="",$scope.qtty_reclamos=0,$scope.control=function(){var request=$http({method:"post",url:"lib/get_qtty_claim.php",data:{id_empresa:$rootScope.User.id_empresa}});request.success(function(data){var resp=eval(data);Array.isArray(resp)?resp.length>0&&($scope.qtty_reclamos=resp.cant):resp.cant?$scope.qtty_reclamos=resp.cant:$scope.qtty_reclamos=0})};var stopTime=$interval(function(){$scope.control()},5e3);$scope.$on("$destroy",function(){console.log("Destroy interval"),$interval.cancel(stopTime)}),$scope.getOne=function(){$mdToast.show($mdToast.simple().textContent("Obteniendo Reclamo!").position("bottom").hideDelay(3e3));var request=$http({method:"post",url:"lib/processor.php",data:{id_usuario:$rootScope.User.id,id_empresa:$rootScope.User.id_empresa}});request.success(function(data){var result=eval(data);"1"==result.ERROR?($scope.reclamos.count=result.length,$scope.reclamos.data=result.DATA):"0"==result.ERROR?$mdToast.show($mdToast.simple().textContent("No Hay Reclamos pendientes para Procesar.").position("bottom").hideDelay(3e3)):($mdToast.show($mdToast.simple().textContent("ERROR DESONOCIDO!").position("bottom").hideDelay(3e3)),console.log(JSON.stringify($scope.reclamos.data)))})},$scope.selected=[],$scope.detail=[],$scope.limitOptions=5,$scope.query={order:"id",limit:10,page:1},$scope.logItem=function(a){},$scope.showAlert=function($event,item){var request=$http({method:"post",url:"lib/get_item_detail.php",data:{id:item.id}});request.success(function(data){var result=eval(data);Array.isArray(result)?$scope.mensajes=result:($scope.mensajes=[],$scope.mensajes.push(result));var parentEl=angular.element(document.body);$mdDialog.show({parent:parentEl,targetEvent:$event,template:'<md-dialog aria-label="List dialog" flex-gt-xs="80">  <md-dialog-content><md-toolbar><div class="md-toolbar-tools"><h2>Detalle del Reclamo </h2><span flex></span></div></md-toolbar>    <md-list>      <md-list-item  class="md-3-line"  ng-repeat="reg in registros"> <div class="md-list-item-text" layout="column">        <h4>Fecha: {{reg.fecha}}</h4>       <p>Mensaje: {{reg.description}}</p></div>          </md-list-item>\t  <md-divider ng-repeat-end ></md-divider></md-list>      <md-toolbar><div class="md-toolbar-tools"><h2>Detalle de la Gestion Actual </h2><span flex></span></div></md-toolbar><md-content   layout-padding flex="auto" ><form name="gestionClaimForm " ng-submit="procesar(detalle_a_enviar)" >\t\t<md-input-container class="md-block">\t\t\t<label>Respuesta</label>\t\t\t<textarea ng-model="detalle_a_enviar" required  name="referencia" md-maxlength="500" rows="5" md-select-on-focus></textarea>\t\t\t<div ng-messages="gestionClaimForm.referencia.$error" role="alert">\t\t\t  <div ng-message-exp="[\'required\']">\t\t\t\tPor Favor ingrese una Detalle.\t\t\t  </div>\t\t\t</div>\t\t</md-input-container>\t<div layout="row" layout-sm="column"  layout-align="space-around">\t\t  <md-progress-circular md-mode="indeterminate" ng-show="spinner"></md-progress-circular>\t</div>\t<div layout-gt-sm="row" layout-align="center center">\t<md-button type="submit" ng-disabled="gestionClaimForm.$invalid" class="md-raised md-primary" >Procesar</md-button>\t</div></form></md-content>  </md-dialog-content>  <md-dialog-actions>    <md-button ng-click="closeDialog()" class="md-primary">      Cerrar Ventana    </md-button>  </md-dialog-actions></md-dialog>',locals:{mensajes:$scope.mensajes,id_claim:item.id,id_client:item.id_cliente},controller:"DialogControllerMng"}).then(function(a){"OK"==a&&($scope.reclamos=[])})})}}]),myapp.controller("DialogControllerMng",["$scope","$rootScope","$mdDialog","mensajes","$http","id_claim","id_client","$mdToast",function($scope,$rootScope,$mdDialog,mensajes,$http,id_claim,id_client,$mdToast){$scope.registros=mensajes,$scope.id_claim=id_claim,$scope.id_client=id_client,$scope.spinner=!1,$scope.closeDialog=function(){$mdDialog.hide()},$scope.procesar=function(detalle){$scope.spinner=!0;var request=$http({method:"post",url:"lib/processor_update.php",data:{id_usuario:$rootScope.User.id,id_reclamo:$scope.id_claim,mensaje:detalle,id_cliente:id_client}});request.success(function(data){var ret=eval(data);1==ret.STATUS?($mdToast.show($mdToast.simple().textContent("Reclamo Procesado OK").position("bottom").hideDelay(3e3)),$mdDialog.hide("OK")):$mdToast.show($mdToast.simple().textContent("No Se Pudo Procesar el Reclamo ERROR["+ret.MESAJE+"]").position("bottom").hideDelay(3e3))}),$scope.spinner=!1}}]),myapp.controller("NewUserCtrl",["$scope","$location","$cookies","$rootScope","$http","$mdToast",function($scope,$location,$cookies,$rootScope,$http,$mdToast){console.log("NewUserCtrl reporting for duty."),$scope.spinner=!1,$scope.sexos=[{id:"1",nombre:"FEMENINO"},{id:"2",nombre:"MASCULINO"}],$scope.submit=function(){var session_id=getPHPSessId();$scope.vm.password=CryptoJS.AES.encrypt(JSON.stringify($scope.vm.password),session_id.toString(),{format:CryptoJSAesJson}).toString(),$scope.vm.password2=$scope.vm.password,$rootScope.User&&2==$rootScope.User.profile?$scope.vm.id_empresa=$rootScope.User.id:$scope.vm.id_empresa=0;var request=$http({method:"post",url:"lib/register_user.php",data:eval($scope.vm)});request.success(function(data){$scope.spinner=!0;var result=eval(data);1==result.STATUS?($mdToast.show($mdToast.simple().textContent(result.ERROR).position("bottom").hideDelay(3e3)),$scope.vm.password=null,$scope.vm.password2=null,$scope.vm.nombre=null,$scope.vm.apellido=null,$scope.vm.email=null,$scope.vm.bday=null,$scope.vm.telefono=null,$scope.vm.sexo=null,$scope.vm.aceptaterminos=null,$scope.UserForm.nombre.$error={},$scope.UserForm.apellido.$error={},$scope.UserForm.email.$error={},$scope.UserForm.bday.$error={},$scope.UserForm.telefono.$error={},$scope.UserForm.sexo.$error={},$scope.UserForm.password.$error={},$scope.UserForm.password2.$error={},$scope.UserForm.$setValidity(),$scope.UserForm.$setUntouched(),$scope.UserForm.$setPristine(),$scope.UserForm.$submitted=!1):($mdToast.show($mdToast.simple().textContent(result.ERROR).position("bottom").hideDelay(3e3)),$scope.vm.password="",$scope.vm.password2=""),$scope.spinner=!1})}}]),myapp.controller("PendClaimCtrl",["$scope","$location","$cookies","$http","$rootScope","$mdSidenav","$timeout","$q","$mdDialog","$mdToast",function($scope,$location,$cookies,$http,$rootScope,$mdSidenav,$timeout,$q,$mdDialog,$mdToast){console.log("PendClaimCtrl reporting for duty."),$scope.reclamos=[],$scope.searchFish="";var request=$http({method:"post",url:"lib/get_reclamos_pendientes.php",data:{id_cliente:$rootScope.User.id}});request.success(function(data){var result=eval(data);Array.isArray(result)?($scope.reclamos.count=result.length,$scope.reclamos.data=result):($scope.reclamos.data=[],$scope.reclamos.count=1,$scope.reclamos.data.push(result))}),$scope.selected=[],$scope.detail=[],$scope.filter={options:{debounce:500}},$scope.limitOptions=5,$scope.query={order:"id",limit:10,page:1},$scope.logItem=function(a){},$scope.showAlert=function($event,item){var request=$http({method:"post",url:"lib/get_item_detail.php",data:{id:item.id}});request.success(function(data){var result=eval(data);Array.isArray(result)?$scope.mensajes=result:($scope.mensajes=[],$scope.mensajes.push(result));var parentEl=angular.element(document.body);$mdDialog.show({parent:parentEl,targetEvent:$event,template:'<md-dialog aria-label="List dialog" flex-gt-xs="80" ><md-toolbar><div class="md-toolbar-tools"><h2>Detalle del Reclamo </h2><span flex></span></div></md-toolbar>  <md-dialog-content>    <md-list>      <md-list-item  class="md-3-line" ng-repeat="reg in registros"> <div class="md-list-item-text" layout="column">        <h4>Fecha: {{reg.fecha}}</h4>       <p>Mensaje: {{reg.description}}</p></div>          </md-list-item><md-divider ng-repeat-end ></md-divider></md-list>  </md-dialog-content>  <md-dialog-actions>    <md-button ng-click="closeDialog()" class="md-primary">      Cerrar Ventana    </md-button>  </md-dialog-actions></md-dialog>',locals:{mensajes:$scope.mensajes},controller:"DialogControllerPend"})})}}]),myapp.controller("DialogControllerPend",["$scope","$mdDialog","mensajes",function(a,b,c){a.registros=c,a.closeDialog=function(){b.hide()}}]),myapp.controller("ProfileController",["$scope","Upload","$location","$http","$cookies","$rootScope","$mdSidenav","$timeout","$mdToast",function($scope,Upload,$location,$http,$cookies,$rootScope,$mdSidenav,$timeout,$mdToast){console.log("ProfileController reporting for duty."),$scope.sexos=[{id:"1",nombre:"FEMENINO"},{id:"2",nombre:"MASCULINO"}],$scope.showOptions=!1,$scope.Editable=!1,$scope.Editable1=!1,$scope.invalidFiles=[],$scope.spinner1=!1,$scope.spinner=!1,$scope.$watch("files",function(){$scope.upload($scope.files)}),$scope.$watch("file",function(){null!=$scope.file&&($scope.files=[$scope.file])}),$scope.submit=function(){$scope.spinner=!0;var request=$http({method:"post",url:"lib/update_profiile.php",data:{User:$rootScope.User}});request.success(function(data){var result=eval(data);1==result.ERROR&&($scope.Editable=!1,$cookies.putObject("User",$rootScope.User)),$mdToast.show($mdToast.simple().textContent(result.MESSAGE).position("bottom").hideDelay(3e3)),$scope.spinner=!1})},$scope.ChangePassword=function(){$scope.spinner1=!0;var session_id=getPHPSessId(),NewPassword=CryptoJS.AES.encrypt(JSON.stringify($scope.User.password),session_id.toString(),{format:CryptoJSAesJson}).toString(),request=$http({method:"post",url:"lib/update_password.php",data:{new_password:NewPassword,id:$rootScope.User.id}});request.success(function(data){var result=eval(data);1==result.ERROR&&($scope.Editable1=!1,$scope.User.password=null,$scope.User.password2=null,$scope.ChangePasswordForm.password.$error={},$scope.ChangePasswordForm.password2.$error={},$scope.ChangePasswordForm.$setValidity(),$scope.ChangePasswordForm.$setUntouched(),$scope.ChangePasswordForm.$setPristine(),$scope.ChangePasswordForm.$submitted=!1),$mdToast.show($mdToast.simple().textContent(result.MESSAGE).position("bottom").hideDelay(3e3)),$scope.spinner1=!1})},$scope.invalidFile=function(a){$mdToast.show($mdToast.simple().textContent(a).position("bottom").hideDelay(3e3))},$scope.upload=function(a){if($scope.log="",a&&a.length)for(var b=0;b<a.length;b++){var c=a[b];c.$error?$mdToast.show($mdToast.simple().textContent(c.$error).position("bottom").hideDelay(3e3)):Upload.upload({url:"lib/load_file.php",data:{mail:$rootScope.User.email,file:c}}).then(function(a){$timeout(function(){$scope.log="file: "+a.config.data.file.name+", Response: "+JSON.stringify(a.data)+"\n"+$scope.log,console.log("Log: "+$scope.log);var b=JSON.stringify(a.data).search("OK"),c="";b>0?(c="Procesado con Exito ["+a.config.data.file.name+"]",$scope.showOptions=!1,$rootScope.User.picture="images/usersfotos/"+a.config.data.file.name,$cookies.putObject("User",$rootScope.User)):c=JSON.stringify(a.data),$mdToast.show($mdToast.simple().textContent(c).position("bottom").hideDelay(3e3))})},null,function(a){var b=parseInt(100*a.loaded/a.total);$scope.log="progress: "+b+"% "+a.config.data.file.name+"\n"+$scope.log,console.log("Log: "+$scope.log)})}}}]),myapp.controller("RecoverCtrl",["$scope","$location","$cookies","$rootScope","$http","$mdSidenav","$mdToast",function($scope,$location,$cookies,$rootScope,$http,$mdSidenav,$mdToast){console.log("RecoverCtrl reporting for duty."),$scope.recover=function(){var request=$http({method:"post",url:"lib/recover_passwd.php",data:eval($scope.vm)});request.success(function(data){$scope.spinner=!0;var result=eval(data);result?$mdToast.show($mdToast.simple().textContent(result).position("bottom").hideDelay(3e3)):$mdToast.show($mdToast.simple().textContent(result).position("bottom").hideDelay(3e3)),$scope.spinner=!1})}}]),myapp.controller("SearchClaimCtrl",["$scope","$location","$cookies","$http","$rootScope","$mdSidenav","$mdDialog","$mdToast",function($scope,$location,$cookies,$http,$rootScope,$mdSidenav,$mdDialog,$mdToast){console.log("SearchClaimCtrl reporting for duty."),$scope.reclamos=[],$scope.spinner=!1,$scope.Buscar=function(){$scope.spinner=!0;var request=$http({method:"post",url:"lib/get_reclamos_search.php",data:{id:$scope.nroreclamo,id_empresa:$rootScope.User.id_empresa}});request.success(function(data){$scope.spinner=!0;var result=eval(data);Array.isArray(result)?($scope.reclamos.count=result.length,$scope.reclamos.data=result,0==result.length&&$mdToast.show($mdToast.simple().textContent("No se encontraron registros para la Busqueda!!").position("bottom").hideDelay(3e3)),$scope.spinner=!1):($scope.reclamos.data=[],$scope.reclamos.count=1,$scope.reclamos.data.push(result),$scope.spinner=!1),$scope.spinner=!1})},$scope.selected=[],$scope.detail=[],$scope.filter={options:{debounce:500}},$scope.filter.show=!1,$scope.removeFilter=function(){$scope.filter.show=!1,$scope.query.filter="",$scope.filter.form.$dirty&&$scope.filter.form.$setPristine()},$scope.limitOptions=5,$scope.query={order:"id",limit:10,page:1},$scope.logItem=function(a){},$scope.showAlert=function($event,item){var request=$http({method:"post",url:"lib/get_item_detail.php",data:{id:item.id}});request.success(function(data){var result=eval(data);Array.isArray(result)?$scope.mensajes=result:($scope.mensajes=[],$scope.mensajes.push(result));var parentEl=angular.element(document.body);$mdDialog.show({parent:parentEl,targetEvent:$event,template:'<md-dialog aria-label="List dialog" flex-gt-xs="80" ><md-toolbar><div class="md-toolbar-tools"><h2>Detalle del Reclamo </h2><span flex></span></div></md-toolbar>  <md-dialog-content>    <md-list>      <md-list-item  class="md-3-line" ng-repeat="reg in registros"> <div class="md-list-item-text" layout="column">        <h4>Fecha: {{reg.fecha}}</h4>       <p>Mensaje: {{reg.description}}</p></div>          </md-list-item><md-divider ng-repeat-end ></md-divider></md-list>  </md-dialog-content>  <md-dialog-actions>    <md-button ng-click="closeDialog()" class="md-primary">      Cerrar Ventana    </md-button>  </md-dialog-actions></md-dialog>',locals:{mensajes:$scope.mensajes},controller:"DialogControllerSrch"})})}}]),myapp.controller("DialogControllerSrch",["$scope","$mdDialog","mensajes",function(a,b,c){a.registros=c,a.closeDialog=function(){b.hide()}}]),myapp.controller("newClaimController",["$scope","$location","$http","$cookies","$rootScope","$mdSidenav","$timeout","$q","$mdToast",function($scope,$location,$http,$cookies,$rootScope,$mdSidenav,$timeout,$q,$mdToast){function querySearch(a){var b,c=a?$rootScope.Companies.filter(createFilterFor(a)):$rootScope.Companies;return self.simulateQuery?(b=$q.defer(),$timeout(function(){b.resolve(c)},1e3*Math.random(),!1),b.promise):c}function typeOf(a){return{}.toString.call(a).split(" ")[1].slice(0,-1).toLowerCase()}function createFilterFor(a){var b=angular.lowercase(a);return function(a){return 0===a.value.indexOf(b)}}console.log("newClaimController reporting for duty.");var self=this;self.selectedItem=null,self.searchText=null,self.querySearch=querySearch,self.simulateQuery=!1,self.categories=[],$scope.LoadCategories=function(){var request=$http({method:"post",url:"lib/get_categories.php",data:{id_empresa:$scope.ctrl.selectedItem.id}});request.success(function(data){var response=eval(data);Array.isArray(response)?$scope.categories=response:($scope.categories=[],$scope.categories.push(response))})},$scope.altaReclamo=function(){var request=$http({method:"post",url:"lib/new_reclamo.php",data:{empresa:$scope.ctrl.selectedItem.id,identificador:$scope.ctrl.identificador,detalle:$scope.ctrl.detalle,cliente:$rootScope.User.id,categoria:$scope.ctrl.categoria}});request.success(function(data){var response=eval(data);0==response.error&&$location.path("/pend_claim"),$mdToast.show($mdToast.simple().textContent(response.mensaje).position("bottom").hideDelay(3e3))});
}}]),myapp.controller("oldClaimCtrl",["$scope","$location","$cookies","$http","$rootScope","$mdSidenav","$mdDialog","$mdToast",function($scope,$location,$cookies,$http,$rootScope,$mdSidenav,$mdDialog,$mdToast){console.log("oldClaimCtrl reporting for duty."),$scope.reclamos=[],$scope.searchFish="";var request=$http({method:"post",url:"lib/get_reclamos_old.php",data:{id_cliente:$rootScope.User.id}});request.success(function(data){var result=eval(data);Array.isArray(result)?($scope.reclamos.count=result.length,$scope.reclamos.data=result):($scope.reclamos.data=[],$scope.reclamos.count=1,$scope.reclamos.data.push(result))}),$scope.selected=[],$scope.detail=[],$scope.filter={options:{debounce:500}},$scope.limitOptions=5,$scope.query={order:"id",limit:10,page:1},$scope.printisread=function(a){return 1==a?'<i class="fa fa-check" aria-hidden="true"></i>':'<i class="fa fa-times fa-unread"  aria-hidden="true"></i>'},$scope.logItem=function(a){},$scope.showAlert=function($event,item){var request=$http({method:"post",url:"lib/get_item_detail_old.php",data:{id:item.id}});request.success(function(data){var result=eval(data);Array.isArray(result)?$scope.mensajes=result:($scope.mensajes=[],$scope.mensajes.push(result)),$scope.mensajes.length>0&&0==item.isread&&(item.isread=1),$rootScope.UnreadMessages.cant>0&&($rootScope.UnreadMessages.cant=$rootScope.UnreadMessages.cant-1);var parentEl=angular.element(document.body);$mdDialog.show({parent:parentEl,targetEvent:$event,template:'<md-dialog aria-label="List dialog" flex-gt-xs="80" ><md-toolbar><div class="md-toolbar-tools"><h2>Detalle del Reclamo </h2><span flex></span></div></md-toolbar>  <md-dialog-content>    <md-list>      <md-list-item class="md-3-line" ng-repeat="reg in registros"> <div class="md-list-item-text" layout="column">        <h4> Fecha: {{reg.fecha}}</h4>       <p> Mensaje: {{reg.description}}</p></div>          </md-list-item>\t  <md-divider ng-repeat-end ></md-divider></md-list>  </md-dialog-content>  <md-dialog-actions>    <md-button ng-click="closeDialog()" class="md-primary">      Cerrar Ventana    </md-button>  </md-dialog-actions></md-dialog>',locals:{mensajes:$scope.mensajes},controller:"DialogControllerOld"})})}}]),myapp.controller("DialogControllerOld",["$scope","$mdDialog","mensajes",function(a,b,c){a.registros=c,a.closeDialog=function(){b.hide()}}])}();